<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Comprobador de Loter√≠a de Nueva York</title>
	<link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css">
</head>

<body>
	<main class="container">
		<header>
			<h1>Comprobador de Loter√≠a de Nueva York (Usando una API, no EJS üòÄ)</h1>
		</header>

		<section class="section">
			<h2>Comprobar Los N√∫meros Premiados De Una Fecha Espec√≠fica</h2>
			<form id="checkNumbersForm">
				<label for="date">Selecciona una fecha:</label>
				<input type="date" id="date" name="date" required>
				<button type="submit">Comprobar</button>
			</form>
			<label for="numbersResult">N√∫meros premiados:</label>
			<input type="text" id="numbersResult" readonly></div>
		</section>

		<section class="section">
			<h2>Comprobar Tus N√∫meros</h2>
			<form id="checkYourNumberForm">
				<label for="yourDate">Selecciona una fecha:</label>
				<input type="date" id="yourDate" name="yourDate" required>
				<label for="yourNumbers">Introduce tus n√∫meros (separados por espacio):</label>
				<input type="text" id="yourNumbers" name="yourNumbers" placeholder="Ejemplo: 12 34 56 78 90 12 34"
					required pattern="\d+(\s\d+){0,6}">
				<button type="submit">Comprobar</button>
			</form>
			<label for="yourNumbersResult">Cantidad de aciertos y premio obtenido:</label>
			<input type="text" id="yourNumbersResult" readonly></div>
		</section>
	</main>

	<script>
		document.querySelector('#checkNumbersForm').addEventListener('submit', async (e) => {
			e.preventDefault();
			const date = document.getElementById('date').value;

			// 1. Usar el m√©todo fetch para hacer una petici√≥n de tipo GET a /api/check-date
			const response = await fetch(`/api/check-date?date=${date}`);

			// 2. Procesar la respuesta de la API
			const data = await response.json();

			if (response.ok) {
				// 3. Rellenar el campo #numbersResult con los n√∫meros premiados
				document.querySelector('#numbersResult').value = data.winningNumbers;
			} else {
				document.querySelector('#numbersResult').value = data.message;
			}
		});

		document.querySelector('#checkYourNumberForm').addEventListener('submit', async (e) => {
			e.preventDefault();
			const date = document.getElementById('yourDate').value;
			const yourNumbers = document.getElementById('yourNumbers').value;

			// 1. Usar el m√©todo fetch para hacer una petici√≥n de tipo GET a /api/get-computed-results
			const response = await fetch(`/api/get-computed-results?date=${date}&playedNumbers=${yourNumbers}`);

			// 2. Procesar la respuesta de la API
			const data = await response.json();

			if (response.ok) {
				// 3. Rellenar el campo #yourNumbersResult con la cantidad de aciertos y el premio obtenido
				document.querySelector('#yourNumbersResult').value = `Aciertos: ${data.matchNumbers}, Premio: ${data.prize}`;
			} else {
				document.querySelector('#yourNumbersResult').value = data.message;
			}
		});
	</script>
</body>

</html>